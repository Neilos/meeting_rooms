
<% unless @membership.user %>
  <div class="col-lg-6">
    <div class="input-group">
      <%= search_field(:user, :email, :class => "form-control") %>
      <span class="input-group-btn">
        <button class="btn btn-default" type="button">Search for user by email</button>
      </span>
    </div>
  </div>
<% end %>

<% unless @membership.organization %>
  <div class="col-lg-6">
    <div class="input-group">
      <%= search_field(:organization, :name, :class => "form-control", :id => "org_search_box") %>
      <span class="input-group-btn">
        <button  class="btn btn-default" type="button" onclick="searchForOrganizationByName()">Search for organization by name</button>
      </span>
    </div>
  </div>
  <br/>
<% end %>
<div id="search_results"></div>

<dl class="dl-horizontal">
  <dt><strong><%= ActiveRecord::Base.human_attribute_name(:user_id) %>:</strong></dt>
  <dd><%= @membership.user.name if @membership.user %> </dd>
  <dt><strong><%= ActiveRecord::Base.human_attribute_name(:organization_id) %>:</strong></dt>
  <dd><%= @membership.organization.name if @membership.organization %> </dd>
</dl>

<%= form_for @membership, :html => { :class => 'form-horizontal' } do |f| %>
  <% if @membership.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@membership.errors.count, "error") %> prohibited this membership from being saved:</h2>

      <ul>
      <% @membership.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <% if @permission_set.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@permission_set.errors.count, "error") %> prohibited this permission_set from being saved:</h2>

      <ul>
      <% @permission_set.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>
  
  <div class="control-group">
    <%= f.label :user_id, :class => 'control-label' %>
    <div class="controls">
      <%= f.text_field :user_id, :class => 'text_field', :value => (@membership.user.id if @membership.user) %>
    </div>
  </div>

  <div class="control-group">
    <%= f.label :organization_id, :class => 'control-label' %>
    <div class="controls">
      <%= f.text_field :organization_id, :class => 'text_field', :value => (@membership.organization.id if @membership.organization) %>
    </div>
  </div>

<%= render 'permission_sets/form_fields' %>

  <div class="form-actions">
    <%= f.submit nil, :class => 'btn btn-primary' %>
    <%= link_to t('.cancel', :default => t("helpers.links.cancel")),
                memberships_path, :class => 'btn' %>
  </div>
<% end %>
